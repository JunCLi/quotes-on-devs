!function(e){const t=window.location.href,o=t=>{e(".entry-content").html(t.content.rendered),e(".entry-title").html(`<a href="${t.link}">${t.title.rendered}</a><span class="quote-source"></span>`),e(".quote-source").html(t._qod_quote_source),console.log(t),console.log(t._qod_quote_source)};e("#another-quote").on("click",n=>{n.preventDefault(),e.ajax({method:"GET",url:random_quote.rest_url+"wp/v2/posts?per_page=100",beforeSend:e=>{e.setRequestHeader("X-WP-Nonce",random_quote.wpapi_nonce)}}).done(e=>{const n=e[Math.floor(Math.random()*e.length)],s=t+n.slug;o(n),history.pushState(n,n.content.rendered,s)}).fail(()=>{}).always(()=>{})}),window.addEventListener("popstate",function(e){null!==e.state?o(e.state):history.go(0)});const n=e=>{s.addClass("hidden");let o='<div class="error-message">\n    <p>There has been an error processing your quote submission, please try again.</p>\n    <button>try again</button>\n    </div>';if("missingcontent"===e)o='<div class="error-message">\n      <p>There has been an error processing your quote submission. Your quote field is empty. Please try again.</p>\n      <button>try again</button>\n      </div>';else if(e.statusText){if("unauthorized"===e.statusText.toLowerCase()){let e=t.split("/"),n=t;for(let t=1;t<e.length;t++)e.slice(0,-t).includes("submit")&&(n=e.slice(0,-t-1));n=n.join("/"),o=`<div class="error-message">\n        <p>Sorry, you must be logged in to submit a quote!</p>\n        <p><a href="${n+="/"}wp-login.php">Click here to login.</a></p>\n        </div>`}}s.after(o)},s=e("#submit-new-quote");s.on("submit",t=>{t.preventDefault();let o={};s.find("[name]").each((e,t)=>{console.log(o[t.name]),"content"===o[t.name]&&""===t.value.trim()&&n("missingcontent"),o[t.name]=t.value}),o.status="publish",o.category="User Submitted",e.ajax({method:"POST",url:submit_quote.rest_url+"wp/v2/posts",data:o,dataType:"json",beforeSend:e=>{e.setRequestHeader("X-WP-Nonce",submit_quote.wpapi_nonce)}}).done(()=>{s.addClass("hidden");s.after('<div class="submit-another"><p>Your quote has been submitted!</p><button type="button">Submit Another Quote</button></div>')}).fail(e=>{n(e)}).always(()=>{})})}(jQuery);